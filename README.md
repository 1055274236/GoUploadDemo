# 文件上传及下载

## 优势

1. 支持大文件上传
2. 减少大文件上传时的内存占用
3. 优化重复文件占用空间

## 劣势

1. 必须连接数据库使用
2. 传输过快时会增加 CPU 负担

## 文件上传

&emsp;&emsp;将文件切割成多个小块，读取设置为两个小块，然后滑动读取下去，查询本次读取中是否含有分隔符，根据文件头位置对本次读取进行操作。

## 存储空间优化

&emsp;&emsp;将每次文件的创建记录在数据库中，然后后续文件上传时查询该文件的 Hash 值，如果数据库中存在且在本地存储中文件未被销毁，则删除本次上传文件，如果本地存储文件已销毁，则修改数据库中信息；如果数据库中不存在文件信息，则创建信息。
